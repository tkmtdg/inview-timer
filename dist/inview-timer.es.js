var t=Object.defineProperty,e=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(e,i,r)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,n=(t,n)=>{for(var o in n||(n={}))i.call(n,o)&&s(t,o,n[o]);if(e)for(var o of e(n))r.call(n,o)&&s(t,o,n[o]);return t};"undefined"!=typeof require&&require;class o{constructor(t=null){this.debug=!1,this.target=null,this.timerID=null,this.timeout=3e3,this.timerLoop=!1,t&&Object.assign(this,t)}get debug(){return this._debug}set debug(t){this._debug=t}get target(){return this._target}set target(t){this._target=t}get timerID(){return this._timerID}set timerID(t){this._timerID=t}get timeout(){return this._timeout}set timeout(t){this._timeout=t}get timerLoop(){return this._timerLoop}set timerLoop(t){this._timerLoop=t}log(...t){this.debug&&console.log(this.constructor.name,...t)}makeEvent(t){return new CustomEvent(t,{detail:{inviewTarget:this.target}})}dispatch(t){this.target.dispatchEvent(this.makeEvent(t))}setTimer(){this.log("timer set",{eventTarget:this.target});const t=window.setTimeout((()=>{this.timerID=null,this.log("timer timedout",{eventTarget:this.target}),this.dispatch("timer timedout"),this.timerLoop&&(this.log("timer loop",{eventTarget:this.target}),this.setTimer())}),this.timeout);this.timerID=t}clearTimer(){this.timerID&&(window.clearTimeout(this.timerID),this.log("timer canceled",{eventTarget:this.target}),this.dispatch("timer canceled"))}}class g{constructor(t=null){this.debug=!1,this.observeTargets=[],this.inviewTargets=[],this.inviewTargetOptions=null,this.intersectionObserverOptions=null,t&&Object.assign(this,t)}get debug(){return this._debug}set debug(t){this._debug=t}get observeTargets(){return this._observeTargets}set observeTargets(t){this._observeTargets=t}get inviewTargets(){return this._inviewTargets}set inviewTargets(t){this._inviewTargets=t}get inviewTargetOptions(){return this._inviewTargetOptions}set inviewTargetOptions(t){this._inviewTargetOptions=t}get intersectionObserverOptions(){return this._intersectionObserverOptions}set intersectionObserverOptions(t){this._intersectionObserverOptions=t}log(...t){this.debug&&console.log(this.constructor.name,...t)}observe(){const t=new IntersectionObserver(((t,e)=>{for(const i of t)for(const t of this.inviewTargets)if(t.target===i.target){t.inview=i.isIntersecting;const e=this.inviewTargets.find(((t,e,r)=>t.target===i.target)),r=t.inview?"inview in":"inview out";e.dispatch(r);break}}),this.intersectionObserverOptions);for(const e of this.observeTargets){const i=new o(n({debug:this.debug,target:e},this.inviewTargetOptions));this.inviewTargets.push(i),i.target=e,e.addEventListener("inview in",(t=>{this.log(t.type,{eventTarget:t.target,inviewTarget:i}),i.setTimer()})),e.addEventListener("inview out",(t=>{this.log(t.type,{eventTarget:t.target,inviewTarget:i}),i.clearTimer()})),e.addEventListener("timer timedout",(t=>{this.log(t.type,{eventTarget:t.target,inviewTarget:i})})),e.addEventListener("timer canceled",(t=>{this.log(t.type,{eventTarget:t.target,inviewTarget:i})})),t.observe(e)}}}export{g as InviewTimer};
